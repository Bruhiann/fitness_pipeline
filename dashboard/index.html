<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitness Tracker</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=DM+Sans:wght@300;400;500;600&display=swap');
  :root {
    --bg:#0a0a0f; --surface:#12121a; --surface2:#1a1a26; --border:#2a2a3a;
    --pull:#00ff9d; --push:#ff6b35; --legs:#7c4dff; --abs:#00b4d8;
    --text:#e8e8f0; --muted:#6a6a8a;
    --mono:'Space Mono',monospace; --sans:'DM Sans',sans-serif;
  }
  *{margin:0;padding:0;box-sizing:border-box}
  body{background:var(--bg);color:var(--text);font-family:var(--sans);min-height:100vh}
  .container{max-width:1200px;margin:0 auto;padding:40px 24px}
  header{display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:48px;padding-bottom:24px;border-bottom:1px solid var(--border);flex-wrap:wrap;gap:16px}
  h1{font-family:var(--mono);font-size:clamp(1.8rem,4vw,2.8rem);font-weight:700;letter-spacing:-.02em;line-height:1}
  h1 span{color:var(--pull)}
  .header-sub{font-size:.82rem;color:var(--muted);margin-top:8px;font-family:var(--mono)}
  .status-badge{display:flex;align-items:center;gap:8px;background:rgba(0,255,157,.08);border:1px solid rgba(0,255,157,.2);padding:8px 16px;border-radius:4px;font-family:var(--mono);font-size:.75rem;color:var(--pull)}
  .dot{width:6px;height:6px;border-radius:50%;background:var(--pull);animation:pulse 2s infinite}
  @keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
  .stats-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin-bottom:32px}
  .stat-card{background:var(--surface);border:1px solid var(--border);padding:20px 24px;position:relative;overflow:hidden;transition:border-color .2s}
  .stat-card::before{content:'';position:absolute;top:0;left:0;width:3px;height:100%}
  .stat-card:nth-child(1)::before{background:var(--pull)}
  .stat-card:nth-child(2)::before{background:var(--push)}
  .stat-card:nth-child(3)::before{background:var(--legs)}
  .stat-card:nth-child(4)::before{background:var(--abs)}
  .stat-card:hover{border-color:rgba(255,255,255,.15)}
  .stat-label{font-family:var(--mono);font-size:.65rem;color:var(--muted);text-transform:uppercase;letter-spacing:.1em;margin-bottom:8px}
  .stat-value{font-family:var(--mono);font-size:2rem;font-weight:700;line-height:1}
  .stat-card:nth-child(1) .stat-value{color:var(--pull)}
  .stat-card:nth-child(2) .stat-value{color:var(--push)}
  .stat-card:nth-child(3) .stat-value{color:var(--legs)}
  .stat-card:nth-child(4) .stat-value{color:var(--abs)}
  .stat-sub{font-size:.75rem;color:var(--muted);margin-top:6px}
  .delta{display:inline-block;font-size:.7rem;padding:2px 6px;border-radius:2px;font-family:var(--mono);margin-top:4px;background:rgba(0,255,157,.1);color:var(--pull)}
  .section{margin-bottom:20px}
  .chart-card{background:var(--surface);border:1px solid var(--border);padding:24px}
  .chart-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:20px;gap:12px;flex-wrap:wrap}
  .chart-title{font-family:var(--mono);font-size:.72rem;text-transform:uppercase;letter-spacing:.1em;color:var(--muted)}
  .chart-title span{display:block;font-size:1rem;color:var(--text);margin-top:2px;text-transform:none;letter-spacing:0;font-family:var(--sans);font-weight:500}
  .controls{display:flex;flex-direction:column;align-items:flex-end;gap:8px}
  .day-selector{display:flex;gap:6px;flex-wrap:wrap}
  .day-btn{padding:5px 14px;font-family:var(--mono);font-size:.7rem;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;transition:all .15s;text-transform:lowercase}
  .day-btn:hover{border-color:rgba(255,255,255,.2);color:var(--text)}
  .active-pull{border-color:var(--pull)!important;color:var(--pull)!important;background:rgba(0,255,157,.06)!important}
  .active-push{border-color:var(--push)!important;color:var(--push)!important;background:rgba(255,107,53,.06)!important}
  .active-legs{border-color:var(--legs)!important;color:var(--legs)!important;background:rgba(124,77,255,.06)!important}
  .active-abs{border-color:var(--abs)!important;color:var(--abs)!important;background:rgba(0,180,216,.06)!important}
  select.ex-select{background:var(--surface2);border:1px solid var(--border);color:var(--text);font-family:var(--mono);font-size:.72rem;padding:6px 10px;cursor:pointer;outline:none;min-width:230px;transition:border-color .15s}
  select.ex-select:focus{border-color:rgba(255,255,255,.2)}
  .charts-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px}
  .charts-grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;margin-bottom:20px}
  canvas{max-height:260px}
  .pr-section{margin-bottom:40px}
  .day-pr-block{margin-bottom:28px}
  .day-pr-header{display:flex;align-items:center;gap:10px;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid var(--border)}
  .day-badge{font-family:var(--mono);font-size:.65rem;text-transform:uppercase;letter-spacing:.1em;padding:3px 10px;border-radius:2px}
  .badge-pull{background:rgba(0,255,157,.12);color:var(--pull);border:1px solid rgba(0,255,157,.25)}
  .badge-push{background:rgba(255,107,53,.12);color:var(--push);border:1px solid rgba(255,107,53,.25)}
  .badge-legs{background:rgba(124,77,255,.12);color:var(--legs);border:1px solid rgba(124,77,255,.25)}
  .badge-abs{background:rgba(0,180,216,.12);color:var(--abs);border:1px solid rgba(0,180,216,.25)}
  .pr-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px}
  .pr-card{background:var(--surface2);border:1px solid var(--border);padding:14px 16px;transition:border-color .15s}
  .pr-card:hover{border-color:rgba(255,255,255,.12)}
  .pr-ex-name{font-family:var(--mono);font-size:.7rem;color:var(--muted);margin-bottom:6px}
  .pr-weight{font-family:var(--mono);font-size:1.4rem;font-weight:700;line-height:1}
  .pr-meta{font-size:.72rem;color:var(--muted);margin-top:5px}
  .pr-bar-wrap{margin-top:8px;display:flex;align-items:center;gap:8px}
  .pr-bar{flex:1;height:3px;background:var(--border);border-radius:2px;overflow:hidden}
  .pr-bar-fill{height:100%;border-radius:2px}
  footer{margin-top:40px;padding-top:20px;border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}
  footer p{font-family:var(--mono);font-size:.7rem;color:var(--muted)}
  .pipe-info{display:flex;gap:16px;font-family:var(--mono);font-size:.65rem;color:var(--muted)}
  .pipe-info span{color:var(--pull)}

  .log-section{margin-bottom:40px}
  .log-controls{display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap;align-items:center}
  .log-filter-btn{padding:5px 14px;font-family:var(--mono);font-size:.7rem;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;transition:all .15s;text-transform:lowercase}
  .log-filter-btn:hover{border-color:rgba(255,255,255,.2);color:var(--text)}
  .log-search{background:var(--surface2);border:1px solid var(--border);color:var(--text);font-family:var(--mono);font-size:.72rem;padding:6px 12px;outline:none;min-width:200px;transition:border-color .15s}
  .log-search:focus{border-color:rgba(255,255,255,.2)}
  .log-search::placeholder{color:var(--muted)}
  .log-table-wrap{overflow-x:auto;max-height:420px;overflow-y:auto}
  .log-table{width:100%;border-collapse:collapse;font-family:var(--mono);font-size:.72rem}
  .log-table th{padding:10px 14px;text-align:left;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;font-size:.63rem;border-bottom:1px solid var(--border);position:sticky;top:0;background:var(--surface);z-index:1}
  .log-table td{padding:10px 14px;border-bottom:1px solid rgba(42,42,58,0.5);color:var(--text);white-space:nowrap}
  .log-table tr:hover td{background:rgba(255,255,255,.02)}
  .log-table tr:last-child td{border-bottom:none}
  .type-badge{display:inline-block;padding:2px 8px;border-radius:2px;font-size:.6rem;text-transform:uppercase;letter-spacing:.08em}
  .type-pull{background:rgba(0,255,157,.12);color:var(--pull);border:1px solid rgba(0,255,157,.2)}
  .type-push{background:rgba(255,107,53,.12);color:var(--push);border:1px solid rgba(255,107,53,.2)}
  .type-legs{background:rgba(124,77,255,.12);color:var(--legs);border:1px solid rgba(124,77,255,.2)}
  .type-abs{background:rgba(0,180,216,.12);color:var(--abs);border:1px solid rgba(0,180,216,.2)}
  .side-dot{display:inline-block;width:6px;height:6px;border-radius:50%;margin-right:5px}
  .log-empty{padding:40px;text-align:center;color:var(--muted);font-family:var(--mono);font-size:.75rem}
  @media(max-width:768px){.charts-grid{grid-template-columns:1fr}.stats-row{grid-template-columns:repeat(2,1fr)}header{flex-direction:column;align-items:flex-start}.controls{align-items:flex-start}}
</style>
</head>
<body>
<div class="container">
  <header>
    <div><h1>FITNESS<span>_</span>TRACKER</h1><p class="header-sub">// workout_log.csv → Postgres → dbt → dashboard</p></div>
    <div class="status-badge"><div class="dot"></div>pipeline: active</div>
  </header>

  <div class="stats-row" id="statsRow"></div>

  <div class="section">
    <div class="chart-card">
      <div class="chart-header"><div class="chart-title">body weight<span>Weight Over Time</span></div></div>
      <canvas id="weightChart"></canvas>
    </div>
  </div>

  <div class="charts-grid">
    <div class="chart-card">
      <div class="chart-header">
        <div class="chart-title">lift progression<span>Max Weight per Session</span></div>
        <div class="controls">
          <div class="day-selector" id="liftDayBtns"></div>
          <select class="ex-select" id="liftExSelect"></select>
        </div>
      </div>
      <canvas id="liftChart"></canvas>
    </div>
    <div class="chart-card">
      <div class="chart-header">
        <div class="chart-title">volume<span>Total Volume per Session</span></div>
        <div class="controls">
          <div class="day-selector" id="volDayBtns"></div>
          <select class="ex-select" id="volExSelect"></select>
        </div>
      </div>
      <canvas id="volumeChart"></canvas>
    </div>
  </div>

  <div class="charts-grid">
    <div class="chart-card">
      <div class="chart-header">
        <div class="chart-title">reps<span>Total Reps per Session</span></div>
        <div class="controls">
          <div class="day-selector" id="repsDayBtns"></div>
          <select class="ex-select" id="repsExSelect"></select>
        </div>
      </div>
      <canvas id="repsChart"></canvas>
    </div>
    <div class="chart-card">
      <div class="chart-header">
        <div class="chart-title">sets<span>Sets Completed per Session</span></div>
        <div class="controls">
          <div class="day-selector" id="setsDayBtns"></div>
          <select class="ex-select" id="setsExSelect"></select>
        </div>
      </div>
      <canvas id="setsChart"></canvas>
    </div>
  </div>

  <div class="chart-card pr-section">
    <div class="chart-header">
      <div class="chart-title">progress tracker<span>Days Since Last Progress — Weight or Reps</span></div>
      <div style="font-family:var(--mono);font-size:.65rem;color:var(--muted)">any increase in weight or reps counts as progress</div>
    </div>
    <div id="progressBlocks"></div>
  </div>

  
  <div class="chart-card log-section">
    <div class="chart-header">
      <div class="chart-title">workout log<span>All Logged Sets</span></div>
    </div>
    <div class="log-controls">
      <button class="log-filter-btn active-pull" id="logAll" onclick="filterLog('all')">all</button>
      <button class="log-filter-btn" id="logPull" onclick="filterLog('pull')">pull</button>
      <button class="log-filter-btn" id="logPush" onclick="filterLog('push')">push</button>
      <button class="log-filter-btn" id="logLegs" onclick="filterLog('legs')">legs</button>
      <button class="log-filter-btn" id="logAbs" onclick="filterLog('abs')">abs</button>
      <input class="log-search" id="logSearch" type="text" placeholder="search exercise..." oninput="renderLogTable()">
    </div>
    <div class="log-table-wrap">
      <table class="log-table">
        <thead>
          <tr>
            <th>Date</th>
            <th>Type</th>
            <th>Exercise</th>
            <th>Side</th>
            <th>Set</th>
            <th>Weight</th>
            <th>Reps</th>
            <th>Volume</th>
          </tr>
        </thead>
        <tbody id="logTableBody"></tbody>
      </table>
    </div>
  </div>

<footer>
    <p>workout_log.csv + weight_log.csv → extract_load.py → Postgres → dbt run</p>
    <div class="pipe-info">
      <div>split: <span>pull mon/fri · push tue/sat · legs wed</span></div>
      <div>abs: <span>mon/wed/fri</span></div>
      <div>calves: <span>wed/sat</span></div>
    </div>
  </footer>
</div>

<script>
const API = 'http://localhost:5000/api';
const DAY_COLOR={pull:'#00ff9d',push:'#ff6b35',legs:'#7c4dff',abs:'#00b4d8'};
const DAYS=['pull','push','legs','abs'];

Chart.defaults.color='#6a6a8a';
Chart.defaults.borderColor='#2a2a3a';
Chart.defaults.font.family="'DM Sans',sans-serif";
const grid={color:'rgba(42,42,58,0.6)',drawBorder:false};
const tt={backgroundColor:'#12121a',borderColor:'#2a2a3a',borderWidth:1,titleFont:{family:"'Space Mono',monospace",size:10},bodyFont:{family:"'Space Mono',monospace",size:10}};
const monoTick={family:"'Space Mono',monospace",size:9};

let DATA = { weight: [], sessions: [], progress: [], stats: {} };
let weightChart = null;

async function fetchAll() {
  try {
    const [weight, sessions, progress, stats] = await Promise.all([
      fetch(API+'/weight').then(r=>r.json()),
      fetch(API+'/sessions').then(r=>r.json()),
      fetch(API+'/progress').then(r=>r.json()),
      fetch(API+'/stats').then(r=>r.json()),
    ]);
    DATA = { weight, sessions, progress, stats };
    renderAll();
  } catch(e) {
    document.getElementById('statsRow').innerHTML = `
      <div style="grid-column:1/-1;padding:20px;font-family:var(--mono);font-size:.8rem;color:#ff4444;border:1px solid #ff4444;background:rgba(255,68,68,.05)">
        ⚠ Could not connect to API server. Make sure <strong>python server.py</strong> is running in your fitness_pipeline folder.
      </div>`;
  }
}

function renderStats() {
  const s = DATA.stats;
  document.getElementById('statsRow').innerHTML=[
    {label:'current weight', value: s.current_weight+' lbs', sub:'started '+s.start_weight+' lbs', delta:(s.weight_change>0?'+':'')+s.weight_change+' lbs'},
    {label:'total sessions', value: s.total_sessions,        sub:'since '+s.start_date,             delta:null},
    {label:'total volume',   value: ((s.total_volume||0)/1000).toFixed(0)+'k lbs', sub:'all exercises', delta:null},
    {label:'needs attention',value: (s.most_stale_days||'—')+' days', sub:(s.most_stale||'').replace(/_/g,' '), delta:null}
  ].map(s=>`<div class="stat-card"><div class="stat-label">${s.label}</div><div class="stat-value">${s.value}</div><div class="stat-sub">${s.sub}</div>${s.delta?`<div class="delta">${s.delta}</div>`:''}</div>`).join('');
}

function renderWeightChart() {
  if (weightChart) weightChart.destroy();
  const w = DATA.weight;
  if (!w.length) return;
  const sw = w[0].weight_lbs, ew = w[w.length-1].weight_lbs;
  weightChart = new Chart(document.getElementById('weightChart'),{
    type:'line',
    data:{labels:w.map(d=>d.date),datasets:[
      {label:'Daily Weight',data:w.map(d=>d.weight_lbs),borderColor:'#00ff9d',backgroundColor:'rgba(0,255,157,0.05)',borderWidth:1.5,pointRadius:3,pointBackgroundColor:'#00ff9d',pointBorderColor:'#0a0a0f',pointBorderWidth:1.5,fill:true,tension:0.3},
      {label:'7-day Avg',data:w.map(d=>d.rolling_7d_avg),borderColor:'rgba(0,255,157,0.35)',borderWidth:2,borderDash:[6,4],pointRadius:0,fill:false,tension:0.4}
    ]},
    options:{responsive:true,interaction:{mode:'index',intersect:false},plugins:{legend:{labels:{usePointStyle:true,pointStyle:'line',font:{family:"'Space Mono',monospace",size:10},color:'#6a6a8a'}},tooltip:{...tt,callbacks:{label:ctx=>` ${ctx.dataset.label}: ${ctx.parsed.y} lbs`}}},scales:{x:{grid,ticks:{maxTicksLimit:8,font:monoTick}},y:{grid,ticks:{callback:v=>v+' lbs',font:monoTick},min:Math.floor(ew)-2,max:Math.ceil(sw)+2}}}
  });
}

function exByDay(day){return[...new Set(DATA.sessions.filter(s=>s.day_type===day).map(s=>s.exercise_label))].sort()}
function sesData(label,field){return DATA.sessions.filter(s=>s.exercise_label===label).map(s=>({x:s.date,y:s[field]}))}

function buildCtrl(dayBtnId,selId,chartId,field,defaultDay){
  const btns=document.getElementById(dayBtnId);
  const sel=document.getElementById(selId);
  let activeDay=defaultDay,chart=null;
  const color=()=>DAY_COLOR[activeDay]||'#00ff9d';
  function fillSelect(){
    sel.innerHTML=exByDay(activeDay).map(e=>`<option value="${e}">${e.replace(/_/g,' ')}</option>`).join('');
    sel.style.borderColor=color();sel.style.color=color();
  }
  function draw(){
    if(chart)chart.destroy();
    const c=color(),pts=sesData(sel.value,field);
    const isBar=field==='total_volume'||field==='sets_completed';
    const unit=field==='max_weight'?'lbs':field==='total_volume'?'lbs':field==='total_reps'?'reps':'sets';
    chart=new Chart(document.getElementById(chartId),{
      type:isBar?'bar':'line',
      data:{labels:pts.map(p=>p.x),datasets:[{label:sel.value,data:pts.map(p=>p.y),borderColor:c,backgroundColor:isBar?c+'40':c+'10',borderWidth:isBar?1:2,borderRadius:isBar?2:undefined,pointRadius:isBar?undefined:4,pointBackgroundColor:c,pointBorderColor:'#0a0a0f',pointBorderWidth:1.5,fill:!isBar,tension:0.3}]},
      options:{responsive:true,plugins:{legend:{display:false},tooltip:{...tt,callbacks:{label:ctx=>` ${unit}: ${ctx.parsed.y}`}}},scales:{x:{grid,ticks:{maxTicksLimit:6,font:monoTick}},y:{grid,ticks:{callback:v=>v+' '+unit,font:monoTick}}}}
    });
  }
  DAYS.forEach(day=>{
    const b=document.createElement('button');
    b.className=`day-btn${day===activeDay?' active-'+day:''}`;
    b.textContent=day;
    b.onclick=()=>{btns.querySelectorAll('.day-btn').forEach(x=>x.className='day-btn');b.className=`day-btn active-${day}`;activeDay=day;fillSelect();draw();};
    btns.appendChild(b);
  });
  sel.addEventListener('change',draw);

  // expose redraw for when data loads
  return { fillSelect, draw };
}

const ctrls = {
  lift: buildCtrl('liftDayBtns','liftExSelect','liftChart','max_weight','pull'),
  vol:  buildCtrl('volDayBtns','volExSelect','volumeChart','total_volume','pull'),
  reps: buildCtrl('repsDayBtns','repsExSelect','repsChart','total_reps','pull'),
  sets: buildCtrl('setsDayBtns','setsExSelect','setsChart','sets_completed','pull'),
};

function renderProgressTracker() {
  const today = new Date();
  const byDay = {};
  DATA.progress.forEach(r => {
    if (!byDay[r.day_type]) byDay[r.day_type] = [];
    byDay[r.day_type].push(r);
  });

  const maxDays = Math.max(...DATA.progress.map(r => r.days_since_progress || 0), 1);

  document.getElementById('progressBlocks').innerHTML = DAYS.map(day => {
    const items = byDay[day];
    if (!items || !items.length) return '';
    const c = DAY_COLOR[day];
    return `<div class="day-pr-block">
      <div class="day-pr-header"><span class="day-badge badge-${day}">${day} day</span></div>
      <div class="pr-grid">${items.map(r => {
        const days = r.days_since_progress;
        const pct = Math.min(((days||0) / maxDays) * 100, 100).toFixed(0);
        const urgency = days === null ? '#6a6a8a'
          : days <= 7  ? c
          : days <= 14 ? '#e8c84a'
          : '#ff4444';
        const label = days === null ? 'no data yet'
          : days === 0 ? 'progressed today!'
          : days === 1 ? '1 day ago'
          : `${days} days ago`;
        return `<div class="pr-card">
          <div class="pr-ex-name">${r.exercise_label.replace(/_/g,' ')}</div>
          <div class="pr-weight" style="color:${urgency}">${days === null ? '—' : days} <span style="font-size:.9rem;font-weight:400">days</span></div>
          <div class="pr-meta">last progress: ${r.last_progress_date || 'n/a'} · ${r.total_sessions} sessions</div>
          <div class="pr-bar-wrap">
            <div class="pr-bar"><div class="pr-bar-fill" style="width:${pct}%;background:${urgency}"></div></div>
            <span style="font-family:var(--mono);font-size:.65rem;color:var(--muted)">${label}</span>
          </div>
        </div>`;
      }).join('')}</div>
    </div>`;
  }).join('');
}

function renderAll() {
  renderStats();
  renderWeightChart();
  Object.values(ctrls).forEach(c => { c.fillSelect(); c.draw(); });
  renderProgressTracker();
}

fetchAll();

// ── Workout log table ─────────────────────────────────────────────────────────
let LOG_DATA = [];
let activeLogFilter = 'all';

async function fetchLog() {
  try {
    LOG_DATA = await fetch(API+'/log').then(r=>r.json());
    renderLogTable();
  } catch(e) {
    document.getElementById('logTableBody').innerHTML =
      '<tr><td colspan="8" class="log-empty">Could not load log data.</td></tr>';
  }
}

function filterLog(type) {
  activeLogFilter = type;
  ['all','pull','push','legs','abs'].forEach(t => {
    const btn = document.getElementById('log' + t.charAt(0).toUpperCase() + t.slice(1));
    if (btn) btn.className = 'log-filter-btn' + (t === type ? ' active-' + (type==='all'?'pull':type) : '');
  });
  renderLogTable();
}

function renderLogTable() {
  const search = document.getElementById('logSearch').value.toLowerCase();
  const rows = LOG_DATA.filter(r => {
    const matchType = activeLogFilter === 'all' || r.day_type === activeLogFilter;
    const matchSearch = !search || r.exercise.includes(search) || (r.side||'').includes(search);
    return matchType && matchSearch;
  });

  if (!rows.length) {
    document.getElementById('logTableBody').innerHTML =
      '<tr><td colspan="8" class="log-empty">no results</td></tr>';
    return;
  }

  const c = DAY_COLOR;
  document.getElementById('logTableBody').innerHTML = rows.map(r => {
    const sideColor = r.side === 'left' ? '#00b4d8' : r.side === 'right' ? '#ff6b35' : 'transparent';
    return `<tr>
      <td>${r.date}</td>
      <td><span class="type-badge type-${r.day_type}">${r.day_type}</span></td>
      <td>${r.exercise.replace(/_/g,' ')}</td>
      <td>${r.side ? `<span class="side-dot" style="background:${sideColor}"></span>${r.side}` : '—'}</td>
      <td style="color:var(--muted)">${r.set_number}</td>
      <td style="color:${c[r.day_type]||'var(--text)'};font-weight:700">${r.weight_lbs} lbs</td>
      <td>${r.reps}</td>
      <td style="color:var(--muted)">${r.volume} lbs</td>
    </tr>`;
  }).join('');
}

fetchLog();

</script>
</body>
</html>
